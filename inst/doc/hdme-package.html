<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Oystein Sorensen" />

<meta name="date" content="2018-05-19" />

<title>The hdme package: regression methods for high-dimensional data with measurement error</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">The hdme package: regression methods for high-dimensional data with measurement error</h1>
<h4 class="author"><em>Oystein Sorensen</em></h4>
<h4 class="date"><em>2018-05-19</em></h4>



<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Load the hdme package</span>
<span class="kw">library</span>(hdme)</code></pre></div>
<p>The <code>hdme</code> package contains algorithms for regression problems with measurement error when the number of covariates <span class="math inline">\(p\)</span> is on the same order as the number of samples <span class="math inline">\(n\)</span>, or even larger.</p>
<div id="measurement-error-in-regression" class="section level1">
<h1>Measurement Error in Regression</h1>
<div id="classical-measurement-error-problems" class="section level2">
<h2>Classical Measurement Error Problems</h2>
<p>Consider a linear regression model, <span class="math inline">\(y = X\beta + \epsilon\)</span>, where <span class="math inline">\(y\)</span> is an <span class="math inline">\(n\)</span>-dimensional response vector, <span class="math inline">\(X\)</span> is an <span class="math inline">\(n \times p\)</span> design matrix, and <span class="math inline">\(\epsilon\)</span> is normally distributed error. With <span class="math inline">\(n&gt;p\)</span> (and <span class="math inline">\(X\)</span> positive definite), unbiased regression coefficients are obtained as</p>
<p><span class="math display">\[
\hat{\beta} = (X^{T}X )^{-1} X^{T} y.
\]</span></p>
<p>In many cases, however, the true covariates <span class="math inline">\(X\)</span> are not directly observed. Instead, we have noisy measurements</p>
<p><span class="math display">\[ W = X + U, \]</span></p>
<p>where <span class="math inline">\(W\)</span> is the <span class="math inline">\(n\times p\)</span> measurement matrix, and <span class="math inline">\(U\)</span> is the <span class="math inline">\(n\times p\)</span> matrix of measurement errors. Assume for the moment that the <span class="math inline">\(n\)</span> rows of <span class="math inline">\(U\)</span>, <span class="math inline">\(u_{i}\)</span> are identically and independently distributed with covariance matrix <span class="math inline">\(\Sigma_{uu}\)</span>, i.e.,</p>
<p><span class="math display">\[ u_{i} \sim N(0, \Sigma_{uu}), ~ i = 1,\dots,n. \]</span></p>
<p>Since we do not have measurements of <span class="math inline">\(X\)</span>, using a classical linear regression model now yields coefficient estimates</p>
<p><span class="math display">\[
\hat{\beta}_{naive} = (W^{T}W )^{-1} W^{T} y,
\]</span> which is referred to as the <em>naive</em> estimate in the measurement error literature. Naive estimates are typically biased. For example, when all measurement errors are uncorrelated and each have variance <span class="math inline">\(\sigma_{u}\)</span>, i.e., <span class="math inline">\(\Sigma_{uu} = \sigma_{u} I_{p\times p}\)</span>, the expected value of <span class="math inline">\(\hat{\beta}\)</span> is</p>
<p><span class="math display">\[
E(\hat{\beta}_{naive}) = \frac{\sigma_{x}^{2}}{\sigma_{u}^{2} + \sigma_{x}^2} \beta = \gamma \beta,
\]</span> where <span class="math inline">\(\gamma\)</span> is the attenuation factor. Unbiased estimates for the case of linear regression can be obtained by minimizing the corrected loss function <span class="math display">\[
L_{corr}(\beta) = \|y - W\beta\|^{2} - \beta^{T}\Sigma_{uu} \beta.
\]</span> This <span class="math inline">\(L_{corr}(\beta)\)</span> is not always convex. If the Hessian <span class="math inline">\(W^{T}W - \Sigma_{uu}\)</span> is positive definite, <span class="math inline">\(L_{corr}(\beta)\)</span> is convex, and the estimates can be found using</p>
<p><span class="math display">\[
\hat{\beta}_{corr} = (W^{T}W - \Sigma_{uu} )^{-1} W^{T} y.
\]</span> Otherwise, iteration methods must be used to find a minimum of <span class="math inline">\(L(\beta)\)</span>.</p>
<p>An estimate <span class="math inline">\(\hat{\Sigma}_{uu}\)</span> of <span class="math inline">\(\Sigma_{uu}\)</span> can be typically obtained with replicate measurements.</p>
<p>Similar results hold for generalized linear models, e.g., logistic and Poisson regression: Measurement error typically leads to bias in the naive estimates, and correction methods can be used to obtained unbiased estimates. We refer to the book <span class="citation">Carroll et al. (2006)</span> for a thorough introduction to measurement error modeling.</p>
</div>
<div id="measurement-error-in-high-dimensional-regression-problems" class="section level2">
<h2>Measurement Error in High-Dimensional Regression Problems</h2>
<p>Now consider the same setup as in the previous section, but with high-dimensional data. That is, the number of covariates <span class="math inline">\(p\)</span> is either on the same order as <span class="math inline">\(n\)</span>, or even larger than <span class="math inline">\(n\)</span>. In this case, even in the absence of measurement error, regularization is typically needed (see, e.g., Chapter 3 of <span class="citation">Hastie, Tibshirani, and Friedman (2009)</span>).</p>
<div id="the-lasso" class="section level3">
<h3>The lasso</h3>
<p>The lasso (<span class="citation">R. Tibshirani (1996)</span>) performs <span class="math inline">\(L1\)</span>-regularization, which induces sparsity. A popular <code>R</code> implementation can be found in the <code>glmnet</code> package (<span class="citation">Simon et al. (2011)</span>). For linear regression models, the lasso finds <span class="math inline">\(\hat{\beta}\)</span> minimizing the loss <span class="math display">\[
L(\beta) = \|y - X \beta\|^{2} + \lambda \|\beta\|_{1},
\]</span> where <span class="math inline">\(\lambda\)</span> is a regularization parameter. The lasso can also be formulated as a constrained optimization problem, <span class="math display">\[
\text{minimize }  ~\|y - X\beta\|^{2}~  \text{ subject to }~ \|\beta\|_{1} \leq R,
\]</span> where <span class="math inline">\(R\)</span> is in a one-to-one relationship with <span class="math inline">\(\lambda\)</span>.</p>
<p>A lot of effort has been put into understanding the statistical properties of the lasso, both in the classical <span class="math inline">\(p&lt;n\)</span> case and in the high-dimensional <span class="math inline">\(p&gt;n\)</span> case, summarized in <span class="citation">Bühlmann and Geer (2011)</span>. The results are typically either probabilistic upper bounds on or asymptotic limits for</p>
<ul>
<li>Prediction error <span class="math inline">\(E(\|y_{new} - X_{new}\hat{\beta}\|)\)</span> where <span class="math inline">\((X_{new}, y_{new})\)</span> are a new sample of data.</li>
<li>Sum of squared estimation error <span class="math inline">\(\|\hat{\beta} - \beta\|_{2}^{2}\)</span> or sum of absolute estimation error <span class="math inline">\(\|\hat{\beta} - \beta\|_{1}\)</span></li>
<li>Covariate selection: If true coefficients in the index set <span class="math inline">\(J \subseteq \{1, \dots, p\}\)</span> are nonzero, while the rest are zero, i.e., <span class="math inline">\(\beta_{J} \neq 0\)</span> and <span class="math inline">\(\beta_{J^{C}} = 0\)</span>, under which conditions will the lasso recover the true set of relevant covariates while correctly setting the irrelevant covariates to zero?</li>
</ul>
<p>The impact of measurement error in the lasso for linear models has been studied by <span class="citation">Sorensen, Frigessi, and Thoresen (2015)</span>. The authors show that estimation of <span class="math inline">\(\hat{\beta}\)</span> in the asymptotic limit suffers the same bias as for a multivariate linear model described above. Consistent covariate selection, on the other hand, requires stricter conditions than in the case without measurement error.</p>
<p>Using the <code>glmnet</code> package, we can illustrate the impact of measurement error in a small experiment.</p>
<p>First we set up the parameters and generate random data. In order to repeat the procedure, we create the function <code>create_example_data</code> for doing this. For illustration purposes, we set the true coefficient vector to <span class="math inline">\(\beta = (-2, -1, 0.5, 1, 2, 0, \dots, 0)^{T}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">create_example_data &lt;-<span class="st"> </span><span class="cf">function</span>(n, p, <span class="dt">s =</span> <span class="dv">5</span>, <span class="dt">sdX =</span> <span class="dv">1</span>, <span class="dt">sdU =</span> <span class="fl">0.5</span>, <span class="dt">sdEpsilon =</span> <span class="fl">0.1</span>, <span class="dt">family =</span> <span class="st">&quot;gaussian&quot;</span>) {
  <span class="co"># Independent true covariates with mean zero and standard deviation sdX</span>
  X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n <span class="op">*</span><span class="st"> </span>p, <span class="dt">sd =</span> sdX), <span class="dt">nrow =</span> n, <span class="dt">ncol =</span> p)
  <span class="co"># if Gaussian, response has standard deviation sdEpsilon, and the intercept is zero</span>
  <span class="co"># if binomial, the response is binomially distributed with mean (1 + exp(-X %*% beta))^(-1)</span>
  beta &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">2</span>, <span class="op">-</span><span class="dv">1</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="kw">rep</span>(<span class="dv">0</span>, p <span class="op">-</span><span class="st"> </span>s))
  
  <span class="cf">if</span>(family <span class="op">==</span><span class="st"> &quot;gaussian&quot;</span>) {
    <span class="co"># True coefficient vector has s non-zero elements and p-s zero elements</span>
    y &lt;-<span class="st"> </span>X <span class="op">%*%</span><span class="st"> </span>beta <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dt">sd =</span> sdEpsilon)  
  } <span class="cf">else</span> <span class="cf">if</span> (family <span class="op">==</span><span class="st"> &quot;binomial&quot;</span>) {
    <span class="co"># Need an amplification in the binomial case</span>
    beta &lt;-<span class="st"> </span>beta <span class="op">*</span><span class="st"> </span><span class="dv">3</span>
    y &lt;-<span class="st"> </span><span class="kw">rbinom</span>(n, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> (<span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span>X <span class="op">%*%</span><span class="st"> </span>beta))<span class="op">**</span>(<span class="op">-</span><span class="dv">1</span>))
  }
  
  <span class="co"># The measurements W have mean X and standard deviation sdU. We assume uncorrelated measurment errors</span>
  W &lt;-<span class="st"> </span>X <span class="op">+</span><span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n <span class="op">*</span><span class="st"> </span>p, <span class="dt">sd =</span> sdU), <span class="dt">nrow =</span> n, <span class="dt">ncol =</span> p)
  
  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">X =</span> X, <span class="dt">W =</span> W, <span class="dt">y =</span> y, <span class="dt">beta =</span> beta, <span class="dt">sigmaUU =</span> <span class="kw">diag</span>(p) <span class="op">*</span><span class="st"> </span>sdU))  
}</code></pre></div>
<p>We then call the function to get the data. I use the <code>%&lt;-%</code> from the <code>zeallot</code> package (<span class="citation">Teetor (n.d.)</span>) to get all elements of the list directly from the function call.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Need to attach igraph before zeallot, because of a conflict in the %&lt;-% operator</span>
<span class="kw">library</span>(igraph) 
<span class="kw">library</span>(zeallot)
n &lt;-<span class="st"> </span><span class="dv">100</span>
p &lt;-<span class="st"> </span><span class="dv">500</span>
<span class="kw">set.seed</span>(<span class="dv">1000</span>)
<span class="kw">c</span>(X, W, y, beta, sigmaUU) <span class="op">%&lt;-%</span><span class="st"> </span><span class="kw">create_example_data</span>(n, p)</code></pre></div>
<p>Next we run the lasso with cross-validation on the true covariates and on the noisy measurements. We pick the coefficient estimate at <span class="math inline">\(\lambda_{1se}\)</span>, i.e., on standard error on the sparse side of the cross-validation minimum. This is the default of the <code>coef</code> function for objects of class <code>cv.glmnet</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(glmnet)
<span class="kw">library</span>(dplyr)
<span class="co"># Lasso with cross-validation on data without measurement error</span>
fit1 &lt;-<span class="st"> </span><span class="kw">cv.glmnet</span>(X, y)
<span class="co"># Lasso with cross-validation on data with measurement error</span>
fit2 &lt;-<span class="st"> </span><span class="kw">cv.glmnet</span>(W, y)
<span class="co"># Create a data frame with results ([-1] because we drop the intercept)</span>
lassoEstimates &lt;-<span class="st"> </span><span class="kw">tibble</span>(
  <span class="dt">index =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span>p, <span class="dt">times =</span> <span class="dv">3</span>),
  <span class="dt">beta =</span> <span class="kw">c</span>(beta, <span class="kw">as.numeric</span>(<span class="kw">coef</span>(fit1)[<span class="op">-</span><span class="dv">1</span>]), <span class="kw">coef</span>(fit2)[<span class="op">-</span><span class="dv">1</span>]),
  <span class="dt">label =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="st">&quot;True values&quot;</span>, p), <span class="kw">rep</span>(<span class="st">&quot;No measurement error&quot;</span>, p), <span class="kw">rep</span>(<span class="st">&quot;Measurement error&quot;</span>, p))
  )</code></pre></div>
<p>By plotting all the estimated regression coefficients, we see that when the data are subject to measurement error, the number of false postives may increase. Note that this is not necessarily the case for all choices of parameters.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ggplot2)
<span class="kw">ggplot</span>(lassoEstimates, <span class="kw">aes</span>(<span class="dt">x =</span> index, <span class="dt">y =</span> beta, <span class="dt">color =</span> label)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;p&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title=</span><span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Measurement error leading to false positives&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>We can also focus on the 5 parameters which are truly nonzero. In this case, we see that in the absence of measurement error, the lasso estimates values quite close to truth. With measurement error, on the other hand, the attenuation is quite clear: the estimates are biased toward zero.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(tidyr) 
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'tidyr'</span>
<span class="co">#&gt; The following object is masked from 'package:Matrix':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     expand</span>
<span class="co">#&gt; The following object is masked from 'package:igraph':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     crossing</span>
estimatesOfNonzero &lt;-<span class="st"> </span>lassoEstimates <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">spread</span>(<span class="dt">key =</span> label, <span class="dt">value =</span> beta) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(<span class="st">`</span><span class="dt">True values</span><span class="st">`</span> <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">gather</span>(<span class="dt">key =</span> label, <span class="dt">value =</span> beta, <span class="op">-</span>index)

<span class="kw">ggplot</span>(estimatesOfNonzero, <span class="kw">aes</span>(<span class="dt">x =</span> index, <span class="dt">y =</span> beta, <span class="dt">color =</span> label)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_point</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&quot;p&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.title=</span><span class="kw">element_blank</span>()) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Measurement error leading to attenuation&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="the-dantzig-selector" class="section level3">
<h3>The Dantzig Selector</h3>
<p>The Dantzig selector <span class="citation">Candes and Tao (2007)</span> is closely related to the lasso. It is defined as the solution to the optimization problem <span class="math display">\[
\text{minimize } ~ \|\beta\|_{1}, ~ \text{ subject to }  ~ (1/n)\| X^{T} (y - X\beta)\|_{\infty} \leq \lambda,
\]</span> where <span class="math inline">\(\|\cdot\|_{\infty}\)</span> denotes the maximum component norm. An <code>R</code> implentation of the Dantzig selector can be found in the <code>flare</code> package <span class="citation">Li et al. (2014)</span>. We illustrate it with the same data as in the previous section.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(flare)
n &lt;-<span class="st"> </span><span class="dv">100</span>
p &lt;-<span class="st"> </span><span class="dv">500</span>
<span class="kw">set.seed</span>(<span class="dv">1000</span>)
<span class="kw">c</span>(X, W, y, beta, sigmaUU) <span class="op">%&lt;-%</span><span class="st"> </span><span class="kw">create_example_data</span>(n, p)</code></pre></div>
<p>Calling the <code>slim</code> method in the <code>flare</code> package yields the Dantzig selector solution for the default values of <span class="math inline">\(\lambda\)</span>. We can compare the methods for data with and without measurement error.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># No measurement error, using X</span>
dantzig_fit_x &lt;-<span class="st"> </span><span class="kw">slim</span>(X, y, <span class="dt">nlambda =</span> <span class="dv">10</span>, <span class="dt">method =</span> <span class="st">&quot;dantzig&quot;</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">lambda.min.ratio =</span> <span class="fl">0.3</span>)
<span class="co"># Measurement error, using W</span>
dantzig_fit_w &lt;-<span class="st"> </span><span class="kw">slim</span>(W, y, <span class="dt">nlambda =</span> <span class="dv">10</span>, <span class="dt">method =</span> <span class="st">&quot;dantzig&quot;</span>, <span class="dt">verbose =</span> <span class="ot">FALSE</span>, <span class="dt">lambda.min.ratio =</span> <span class="fl">0.3</span>)</code></pre></div>
<p>Below is the regularization path for the Dantzig selector in the case of no measurement error.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(dantzig_fit_x)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Next is the regularization path for the Dantzig selector in the case of measurement error.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(dantzig_fit_w)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>A generalized Dantzig selector for generalized linear models was introduced by <span class="citation">James and Radchenko (2009)</span>. It is defined as the solution to the optimization problem <span class="math display">\[
\text{minimize } ~ \|\beta\|_{1}, ~ \text{ subject to }  ~ (1/n)\| X^{T} (y - \mu(X\beta))\|_{\infty} \leq \lambda,
\]</span> where <span class="math inline">\(\mu(\cdot) \in \mathbb{R}^{n}\)</span> is the vector valued mean function of the generalized linear model. Examples include logistic regression with <span class="math inline">\(\mu(x) = (1+\exp(-x))^{-1}\)</span> and Poisson regression with <span class="math inline">\(\mu(x) = \exp(x)\)</span>. Using an iterative reweighing algorithm, the generalized Dantzig selector can be solved as a sequence of linear optimization problems of the same form as the Dantzig selector for linear models.</p>
<div id="generalized-dantzig-selector" class="section level4">
<h4>Generalized Dantzig Selector</h4>
<p>To our knowledge, no R package to date contains an implementation of the Generalized Dantzig Selector (GDS), although code is available on <a href="http://www-bcf.usc.edu/~gareth/research/gdscode">Professor Gareth James’ homepage</a>. Since the Generalized Matrix Uncertainty Selector (GMUS) presented later in this vignette is a generalization of the GDS, we have included a function for computing the GDS, called <code>fit_gds</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Number of samples</span>
n &lt;-<span class="st"> </span><span class="dv">1000</span>
<span class="co"># Number of covariates</span>
p &lt;-<span class="st"> </span><span class="dv">50</span>
<span class="co"># Create example data</span>
<span class="kw">c</span>(X, W, y, beta, sigmaUU) <span class="op">%&lt;-%</span><span class="st"> </span><span class="kw">create_example_data</span>(n, p, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</code></pre></div>
<p>Arguments to <code>fit_gds</code>. Only <span class="math inline">\(X\)</span> and <span class="math inline">\(y\)</span> are required.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(fit_gds)
<span class="co">#&gt; function (X, y, lambda = NULL, family = c(&quot;gaussian&quot;, &quot;binomial&quot;)) </span>
<span class="co">#&gt; NULL</span></code></pre></div>
<p>Fit the generalized Dantzig selector on the data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Fit the Generalized Dantzig Selector</span>
gds_estimate &lt;-<span class="st"> </span><span class="kw">fit_gds</span>(X, y, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</code></pre></div>
<p>The result is a list of class <code>gds</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(gds_estimate)
<span class="co">#&gt; [1] &quot;gds&quot;</span></code></pre></div>
<p>The list contains the intercept (which has not been penalized), the regression coefficients <code>beta</code>, the family, the value of <code>lambda</code> and the number of nonzero components of <code>beta</code>. By default, <code>fit_gds</code> uses the value <span class="math inline">\(\lambda_{min}\)</span> corresponding to the minimum cross-validated loss for the lasso, using <code>cv.glmnet</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(gds_estimate)
<span class="co">#&gt; List of 5</span>
<span class="co">#&gt;  $ intercept   : num 0.00137</span>
<span class="co">#&gt;  $ beta        : num [1:50] -3.813 -2.018 0.994 2.258 4.202 ...</span>
<span class="co">#&gt;  $ family      : chr &quot;binomial&quot;</span>
<span class="co">#&gt;  $ lambda      : num 0.00368</span>
<span class="co">#&gt;  $ num_non_zero: num 30</span>
<span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr &quot;gds&quot;</span></code></pre></div>
<p>At the moment, only a single value of <code>lambda</code> is accepted by GDS. We will fix this in the future, as well as adding a cross validation function.</p>
</div>
</div>
</div>
</div>
<div id="corrected-lasso" class="section level1">
<h1>Corrected Lasso</h1>
<div id="corrected-lasso-for-linear-regression" class="section level2">
<h2>Corrected Lasso for Linear Regression</h2>
<p>When an estimate of the measurement error covariance matrix <span class="math inline">\(\Sigma_{uu}\)</span> is available, a corrected lasso can be defined as minimizing the loss <span class="math display">\[
\text{minimize } ~ L(\beta) = \|y - W \beta \|^{2} - \beta^{T} \Sigma_{uu} \beta + \lambda \|\beta\|_{1} ~\text{ subject to } \|\beta\|_{1} \leq R.
\]</span> Because we subtract the positive semidefinite matrix <span class="math inline">\(\Sigma_{uu}\)</span> from the convex function <span class="math inline">\(\|y - W\beta\|^{2}\)</span>, this corrected lasso may be non-convex. In fact, when <span class="math inline">\(p&gt;n\)</span> is is always non-convex. Hence, in order to avoid non-trivial solution, we must constrain the solution to lie in some L1-ball with radius <span class="math inline">\(R\)</span>. Since this problem involves two regularization parameters, <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(R\)</span>, it is more convenient to use the constrained version of the lasso <span class="math display">\[
\text{minimize } ~ L(\beta) = \|y - W \beta \|^{2} - \beta^{T} \Sigma_{uu} \beta  ~\text{ subject to } \|\beta\|_{1} \leq R.
\]</span> <span class="citation">Loh and Wainwright (2012)</span> analyze the properties of these two closely related versions of the lasso. They show that the bounds for the estimates of <span class="math inline">\(\|\hat{\beta} - \beta\|_{2}^{2}\)</span> and <span class="math inline">\(\|\hat{\beta}-\beta\|_{1}\)</span> are of the same order as for the standard lasso without measurement error, where <span class="math inline">\(\hat{\beta}\)</span> is the global minimum of the optimization problem. More remarkably, they show that despite non-convexity, under mild assumptions a projected gradient descent algorithm will converge with high probability to a local optimum which is very close to the global optimum.</p>
<p><span class="citation">Sorensen, Frigessi, and Thoresen (2015)</span> analyzed the covariate selection properties of the same model, and similarly showed that results very similar to those for covariate selection with the standard lasso in the absence of measurement, also hold for this corrected lasso.</p>
<div id="linear-regression" class="section level3">
<h3>Linear Regression</h3>
<p>This package implements the projected gradient descent algorithm proposed by <span class="citation">Loh and Wainwright (2012)</span>. It can be found in the <code>fit_corrected_lasso</code> function. Using the <code>create_example_data</code> function defined above, we illustrate its use.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1000</span>)
<span class="co"># Generate example data</span>
<span class="kw">c</span>(X, W, y, beta, sigmaUU) <span class="op">%&lt;-%</span><span class="st"> </span><span class="kw">create_example_data</span>(n, p)
<span class="co"># Fit the corrected lasso</span>
corrected_fit &lt;-<span class="st"> </span><span class="kw">fit_corrected_lasso</span>(<span class="dt">W =</span> W, <span class="dt">y =</span> y, <span class="dt">sigmaUU =</span> sigmaUU)</code></pre></div>
<p>The object returned is a <code>list</code> with class <code>corrected_lasso</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Class of the object</span>
<span class="kw">class</span>(corrected_fit)
<span class="co">#&gt; [1] &quot;corrected_lasso&quot;</span>
<span class="co"># Object is a list</span>
<span class="kw">typeof</span>(corrected_fit)
<span class="co">#&gt; [1] &quot;list&quot;</span></code></pre></div>
<p>The arguments to the function are shown below.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">args</span>(fit_corrected_lasso)
<span class="co">#&gt; function (W, y, sigmaUU, family = c(&quot;gaussian&quot;, &quot;binomial&quot;, &quot;poisson&quot;), </span>
<span class="co">#&gt;     radii = NULL, no_radii = 20, alpha = 0.1, maxits = 5000) </span>
<span class="co">#&gt; NULL</span></code></pre></div>
<p>If the <code>radii</code> argument is not set, a naive lasso is run on the measurement error data, using cross-validation to find <span class="math inline">\(\hat{\beta}_{naive}\)</span>. The maximum of <span class="math inline">\(R\)</span> is set to <span class="math inline">\(R_{max}=2\|\hat{\beta}_{naive}\|_{1}\)</span>, i.e., the maximum possible solution to the corrected lasso is twice as large as the naive solution, as measured by the L1-norm. The minimum of <span class="math inline">\(R\)</span> is by default set to <span class="math inline">\(R_{min} = 10^{-3}R_{max}\)</span>. The corrected lasso solution is then computed on an equally spaced grid between <span class="math inline">\(R_{min}\)</span> and <span class="math inline">\(R_{max}\)</span>. The length of the grid is set by the <code>no_radii</code> argument, which by default equals <span class="math inline">\(20\)</span>.</p>
<p>The resulting estimates can be visualized using the <code>plot</code> function for objects of class <code>corrected_lasso</code>. Calling the function with no additional arguments returns a plot of the number of nonzero coefficients for each value of the constraint radius. This is equivalent to calling <code>plot(corrected_fit, type = &quot;nonzero&quot;)</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(corrected_fit)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Instead using the additional argument <code>type = &quot;path&quot;</code> yields the full coefficient paths for the estimates for all values of the radius.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(corrected_fit, <span class="dt">type =</span> <span class="st">&quot;path&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="corrected-lasso-for-generalized-linear-models" class="section level2">
<h2>Corrected Lasso for Generalized Linear Models</h2>
<p><span class="citation">Sorensen, Frigessi, and Thoresen (2015)</span> show how we can also corrected for measurement error in the lasso for generalized linear models, using the conditional score method introduced by <span class="citation">Stefanski and Carroll (1987)</span>, combined with the projected gradient descent algorithm used by <span class="citation">Loh and Wainwright (2012)</span> for the corrected lasso for linear models.</p>
<div id="logistic-regression" class="section level3">
<h3>Logistic Regression</h3>
<p>The corrected lasso for logistic regression is implemented in <code>hdme</code>. To illustrate its use, we start by generating some measurement error data with binomially distributed response.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">323</span>)
n &lt;-<span class="st"> </span><span class="dv">100</span>
p &lt;-<span class="st"> </span><span class="dv">50</span>
<span class="kw">c</span>(X, W, y, beta, sigmaUU) <span class="op">%&lt;-%</span><span class="st"> </span><span class="kw">create_example_data</span>(n, p, <span class="dt">sdU =</span> <span class="fl">0.2</span>, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</code></pre></div>
<p>We get logistic regression by specifying <code>family = &quot;binomial&quot;</code> in the call the <code>fit_corrected_lasso()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">corrected_fit &lt;-<span class="st"> </span><span class="kw">fit_corrected_lasso</span>(W, y, sigmaUU, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</code></pre></div>
<p>The plot functions work the same way as for linear regression. By default, the argument <code>type = &quot;nonzero&quot;</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(corrected_fit)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Setting <code>type = &quot;path&quot;</code>, we get the coefficient values along the regularization parameter <span class="math inline">\(R\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(corrected_fit, <span class="dt">type =</span> <span class="st">&quot;path&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAEgCAMAAABrWDzDAAABRFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrYAuOUzMzM6AAA6ADo6AGY6OgA6OmY6ZmY6ZpA6ZrY6kLY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmOgBmOmZmZgBmkJBmkNtmtrZmtttmtv9uTU1uTW5uTY5ubqtuq+R5l/+OTU2OTW6OTY6OyP+QOgCQZgCQZjqQZmaQkDqQkGaQkLaQttuQ27aQ2/+jpQCrbk2rbm6rbo6ryKur5P+siP+2ZgC2Zjq2kDq2kGa2tpC2ttu229u22/+2/9u2//+7nQDIjk3I///bkDrbkGbbtmbbtpDb25Db27bb29vb2//b/7bb/9vb///giwDkq27k///nhhvr6+vtgUHwZurze1n4dm38YdX8cX//tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T////bkJ0pAAAACXBIWXMAAA7DAAAOwwHHb6hkAAATN0lEQVR4nO2d+5/bRhXF5W2DwbS0YZ0mJry6KQ2hWcqjmLQEUwohJG4Lpezm0WbBcdmX/v/f0YxkayTNjOZxR3Ml3/OBrG3Nnj0efTsvja0kJZE8lMQOQOq3CCCSlwggkpcIIJKXCCCSlwggkpcIIJKXCCCSl9wBuvjz60nyytvK439KkvFR9s+3bl45Kn/pUHgiav3Dh5q/xY4qf5UUU84ArScJ11XF8VV2bMz++dahCUDLPR1A7CgBhFKuAJ3Nkqv/StN/3EwO5AVW7MBKdbQhAqincgVomezzn+sJO63f3EySVx+w5+zR97JHi6zt2fsR++dv/MR/NklenW9aoE2h7Nknryejn2QPspK54dlsf5WXzX4p6yS3R7PCX95kT7Pfez97Xd15kjqUI0AXh5sW44vs/yvenY3mm44te1QDaFW8zAHaFuJkZDqoAPTGpDBbVo5eHL56kz/d/Jpp40YKKUeAzmbj8kl2Qt9mp/vK0cUhaxg+n4yFLowxk70+Tz/LECmeFIWyXxwfZb84FrqwrG8cH118nLCjew8YkuNNF5b9gfTT7MB6cvUof50UXRAAFedyMZqvJ7wZYee7AlDxeio+yQrl7Rj3EgDiQ50Ff/7FJ7+aJFuANoXXk1d+/Fe33CRowQDEe5PVaL7KOx3WAdUAKvob9qQslI+ILg6rAHHnZWZRTPTG4iCaF2b9Y/LmA/d3TQKT9xjo0zcfBAIo68ze+O1fvpw1AUo/Z6Mh7byN1JF8Z2Fns72HYhe2HdnqurBNITlA+WvMlpUTxkAlQJn++UsaRWOQ/zrQfnUQ/UE2Sz+sj4H4IHo9Yw/EQiJAo/nW+Pv5IDpD54jN+LMyy80EjhdeZSXSi483v0GKKe+VaNYglNP4onvar7VAxeuVJ8WcbANQOY1/ZZL3T5tJPgMoXwcqChcHaF0Rg9yvhX3z/mR7LWy9XUhkj/iLVYDYQiKbvOdPNoUEgM5ushl9ysdAGY98hMyXJz9g8zF29N9lYb6QeJX4wSB0V+Mr8zsSehFAJC8RQCQvEUAkL6EDiNQvEUAkLxFAJC8RQCQvEUAkLxFAJC8RQCQvOQL0XC7V6/aCc6JQQZwIoKhOKEMRQKGtBh6KAAptNfBQBFBoq4GHIoBCWw08FAEU2mrgoQig0FYDD0UAhbYaeCgCKLTVwEM1nY4zqQoTQDGdUIYqnY4L6QoTQDGdUIZKTcDZFiaAYjrhCnVsAc72zxJAMZ1whKpxQ4Po0FZDCaVocAig0FZ9D9XSU3UJEKlP2oATwptaoChO3YSyHBtTFxbaqi+hHCZVCidNYQIoplOoUE7gSJ1aCxNAMZ3gQ3mhU3EyLEwAxXSCDAWATuFkVZgAiukEYuU20lGLAApthSaUSA5t5wjsNKxQzUaHAArsNJRQqv6KAArsNIBQ2qEOARTYqd+h2ofJBFBgp96GMpxiEUCBnfoYKtgVLDgnAiiqk9rKemmHAArs1JtQjsuCBFBgpx6E6u4SKJwTARTVKdYlUDgnAiiqU6xLoHBOBFA0p5iXQOGcCKAYTiU6iEK5ORFAHTvVmh0coTycCKAOnXw/g6UVARTYKW4o1XgHY00FAej01nR6lz96Mp1O33pMABkL4zV0OCdDgM5/cT89fec+e/joLrVApgXRXkOHc5IDtEySg6V4O+2XNzboXH54nwAyKIP7GjqckxSgxZUvZwf8xtr1Vij798606My+k0nfbu2ogn18GLNEgM5mB9n/0tXeQ7HE5b3b7AfryMpWCIJhPeBgTp2E6ss1dDgnY4DO79wun2zHQRAR9PnAnAKH6tc1dDgnGUDpknVhZ7N94aXTW+LYmQAS1Mdr6HBOUoDSVZJJzs/L60/Ty49oGs/U32voVk7PuFSFpQA1xBZ/srHz6c8es4fXthOxzt8MCqsU7kIoxppiTs8E6QtLAGIDINYMVQfRUnXyZnBZDeIaukzPjKGp/FkCyFwbdlCF8nKSMuM5BlomG42lzOwmQJV2B0soN6fWhgZiGt+Ozu4A1OyzEISydLLqnehqPJhV8I+hB5872Q5prDNJAVpPeBe202Mg3VgZLUDOzLhnkgF0cbh/cXhg1JFBRNDnA3MCvIaOCyAQaESBjIEW++lKvBy/IwCZzdFxAFSjBtFKNANoOd61abzF+k5cgBTNDSKA0gWnZ7kzLZDt2mAMgFr7KUwAZYOgdJGM5q389B8gp3XlrgAKN/mGc5ICZC6ICPp8YE4NK/drEkEB6mTyDee0mwB5Xs8KEsp3JoUJoEGvAwFcCwUNBTUFRwRQYzf0UADCtAcDeO0GFUBDvBYGugnDJxSO1Rs4J3kLNCiA4DdhuDjhWr2Bc5IBZLSE2AuAAm3CsHHCuXoD5yQFaAiD6JCbMEycDIc4CGrKz0kGEFtH7HMLFHwThs7Jcmw8SIB6PIjuZhOGxMl1UjVIgCwG0ZgU5QPFG246/8PYVB0Dvda3QbTJJB00VM+X/+CcZACdzZI+DaJNV3hAQg1k+Q/OSdoCmQsigj6f/rDN8qBXqAo4ODaU4XDqMUCdfBGGtMUhgITCdYD4V3Mg7cKOK/KyapF+UkUACYWRt0BeyFQFt/xHAAmFJQAh+mjzcUfnym5svDMAfSVIVRg1QMeBz5Xj8t8wAfqqKZM/2wAIz2fjWZ8V5lx5TsaHA5CUlqFcyjgGc8oFt/zXV4AMm5iBDKJBb0YCu/yHHCBJX2TcI1lnkgKUT+VNNgVBRJDrGMipJAfRcAPEypcTmExSgBbjdLn3cBlzDLSZsns41RudvgJkyAmuaTzbVx9xFua5jVDeXyEHqNOOB85JARD7jt94ALndT2s7J1cMdbqtYSUPKDoeOCcZQBeH+6vRnHVkcQASV5xbnJ49a8MGKpTCqaftBpyTDCC2J3qcLgy+WyEIQJUrFgonl/m4V6iBtRuGTl8LUhWWAWQuyzdjcj2rdSe863zcq+OxdgIMFdzpa5VM/mx3AOX0tCBUP1xz8lnMget4+gqQIScAC4mN+4X5A1SSoWuGGkdq1x/M35gg8I4HOUA+DYp1JilA8vuFeQBUZ0bFUPPVwskaHgkuKHoLQCtfTmAyyQCS3y/MGSA5LbIXGy/x828Oj76N6StAITqeqn5vItUbCAyQpr9qHKo8/UqYnrf1PGY9E3KAOuh4DNnw78Ik9ws7vzO9/rT2qBWg1kmXWIA9bC7rVP5CHZRYQ18TJyUP4Tse20ZE7WRSWAZQ835hl/fupk9uVB+1AWS2BfX4OOeF/3je4EH6F9zGwl4AheIhRMfjbumQSQ5QQ+fvPU7ZzcLER1qAtI1PtaHhRY+b7Ni/Gb282o3woYwGIlAdj2GmnwtSFTYD6PTdp8Vdm8tHmrs2/5c0OOkBaQOI3egyx6Z8pG2BTk5OpEdevLD5b+HFi9TuF3QSwv5HJWunb4Ppj7ZSh/JU6fR3QarC7i2QFqBMKoSM3whjJ7VlTi2TGlaS5UecVyhr4jrIJBQ2A8h6DMQlb4ZMgXixdYJBKMgszJq4DlBUkqVCUf32DP6sBCDJx3ou793ezsJuG87CuKQMmQBRlEnNf6NNyNeBOkDRFqw6WdI3YAZQsfrDmh6LdaBcMobaeNgCkzZecRZygOCcrMkyarJUf7YBUIjPhTUZ0vNQHhScfBHaGYCUsm7LDEZWmhbIROZvpomQ8n2KpKSqA/YigKydDJovGUAWsnkz9WZIgUP15VR30E4YzxXKUCBbWsN8vUuNIRkOtZcaTu4IYTxXKEN5AxT0Xhk1hGpHG3hInFwRwniuUIaCmsaHAaiGUIUGCRpSJzeEMJ4rlKEAWqDAX65QRUjyqNXJBSGM5wplKP8xUPh7ZYgIFTDImVA6vdDJLZSxCCChsASgTr4jsYaQqklxqxYpSBjPFcpQIa6FwQNUnZIpeyS/aqmAhPFcoQzVF4CeKy/YOzjp1dK52YoAEgpLAQrwuTCF2hCCPletIyVjJxgNEyDwz4XppEco5LlqH3dHCNU3JxlAwJ8La5UOoc7OlQ1MBJBQGAFAfDyt2AMb5Vy1LQwQQEJhCUCyz4WFBSjXyUkTJCznynCtqdtQGJykADU/F9YJQBuJIGEBqOkEA9NAATIWRASlTkpB2AWsYfemiQDyj6DPl/84AYCpqxq2gml4AGG+3VMuV5Bi1HAvL9ANsQWSyRai2OdKClPsUN5OPQaIyQYiTOdqOPM5KUAXh/s22xIji0EUO4OXRJhiZ3FW/VYHhhtbIRjWA25WzKQlwtQCKa3a1jC7CAWxEs1+ILjhnJVTG0S9AEgiQ6QIIAgn3fSsrwA1hWk4LgOI3aqHYdT1pQwoJwVEwwFIVOzhuBSgyJcyIJwkEMUPFdSKOUW4vCIHyFgQEfT5PH63BhGOUMGsIg3HhwwQkwARnlBBrCINxxsA4b+UYa0CIlyhwK0iDceH3gJtBHZNn2k4AIly6/PkLRCK234DOz1PwSgaJkASJwOYdgogLgCIdgYgk8J1gIRvKBvKGKhp5dkUEUBC4QZAwb+dw0oBz5U7RQSQULgO0OC7sKoib01DWVMEkK1VvK1pKGuKxkAuVnG2pqGsKRoDuVqZQkQACYUlAFkIIoI+H5iToVW3W9NQ1hQAQN19O0drPjAnC6vutqahrCl/gDr9do6WfGBOllbdbE1DWVMQY6COv1xBkw/MycUq+NY0lDVFAIFaBd2ahrKm/LuwSN/OEdbJxyrY1jSUNQUwiG5uaT29NZ3e5Y+eTKfTt8xuOAcgPOcqyNY0lDUVYhrPbnJ5+g6/0eWju7vXAm0EvjUNZU2FAOjljQ06lx/eF16HiKDPB+YEZQW5Mw1nTcGsAzU/lZHfavf8zrTozDS3/R66ev9pani1fy6M3Sw1E+vIylYIgmE94GBO0KGwbW5E1ALVPpn6aDq9wVqe22WJ7TgIIoI+H5hTgFAADGGsKWiAuE5viWNnAmgj3xERxpoCWAdqdGElPy+vP00vP9rBabzayYchjDUVYhDNFn+ysTO77Xf28Np2IgYRQZ8PzCloKAS7Y1EBZCyICPp8YE7BQzlBhLGmCKDQVmona4gw1pQvQHwMfXFosh2IAJLICiKMNeUJ0HqSD34WJve9hIigzwfm1GkoY4gw1pQnQItx/QEB5ORkBBHGmvIDqNxRT/uB/J1aIcJYUwRQaCs7Jy1EGGvKDyD2HdG5THbVQ0TQ5wNzihpKCRHGmvIcAy2LhqckiQACcZJCFDuUt1MToHQxmqesK9vdj/WEc2pAhCGUl5MEoGwinyQJp4gACuBUgQhLKGcnGUAWgoigzwfmhCrUFiJMoZycCKBoTvyji9hCWTsRQFGdAHdYE0CBnfCGgoGIAArshDuUP0QEUGAn/KGwfPMnARTaKmAod4gIoMBO/Qnl9vWxBFBgp56FsqaIAArs1MdQNhT1EyBSeJ304oPU1AJFcTK2am+L+tkCQUTQ5wNzGkAoLUUEUGCnoYRSUUQABXYaVCg89xQmgKI6+VjVmiICKLDTMEOVFBFAgZ0GHCrmziICKKoToBXcbYUJoNBWeEOBUEQAhbZCHsqXIgIotFUfQnlQRACFtupNqJPwt4QlgKI6dRLKFiMCKLRVL0OZY0QAhbbqcSgTjAig0Fa9D6XHiAAKbTWQUCqMCKDQVoMK1cSIAAptNcBQIkYEUGirwYY6ObFeOSKAojqhDJXagEQARXVCGap2VU0PEgEU1QllqKaTBiJTgMp7NZ/fmV5/SgChs4rkZArQ9hZzl/fupk9uEEDorHADVN4l9fy9xym7bRgBhMwKN0DlvZpP331a3L95h+/aTGqoBaDyXs3slpc5QEwQDOsBB3OiUEGcDADK79qcFuOgsgUigFBZ4QWoJIkBRGOgwYcKAVB5r+bLe7dpFgbmhDJUkBYov1cza3oq60AKoRxcUyhDOWWC/YIpjNVCoUxFAMlFoQxFAMlFoQyFACDSzokAInmJACJ5iQAieYkAInkJECCTlcbOVW6IwyN+RQhZbfFMLpUFB1B1xxkWbTfE4dFLdpKQ1RbP5FRZcABVr7YiUbkhDo0eXfsDuzCEqrbyTE6VBQdQdb8HEpUb4hCJgYOttoqrnfaVBQdQdccZEpUb4hCJnSxstcWhdqmsgbdAXNjGQVhbIC7byhr4GIgLI0DYagsBQNUdZ0hUbohDJHaysNXWplu1rqwdWAe6hqejyIV5Hci6smglmuQlAojkJQKI5CUCiOQlAojkJQKI5CUCiOQlAojkJQLIRau9h+vvzmOnQCECyEUZQLEjYBEB5CICaCsCqF3r136dZH3WJEmS/TQ9myWj3/AujPdi7B9+6CB2zDgigNq1nowZNxkhy72HZ7P97HEFoPznZDcJIoDaxdn431HKaeG917IK0Gs73KERQO0qJlyrrJ8azZdXjlinVunCFkkyjh0ylgigdnFQzmajOXskA4gPjHZ0XE0AtYszsmLgrEZ5F7baqwFUjJF2UARQu3KAWAM0Gc3PZuPNIJqNpy8OC6Z2dWGRAGpXzkY20Bn9Lmtmymk8n77/9AfzYnQUO2YcEUAkLxFAJC8RQCQvEUAkLxFAJC8RQCQvEUAkL/0fIDlcVar5qBgAAAAASUVORK5CYII=" /><!-- --></p>
</div>
<div id="poison-regression" class="section level3">
<h3>Poison Regression</h3>
<p>Poisson regression is also available, by using the argument <code>family = &quot;poisson&quot;</code> to <code>fit_corrected_lasso</code>.</p>
</div>
</div>
<div id="model-tuning" class="section level2">
<h2>Model Tuning</h2>
<p>The corrected lasso for linear regression has a clearly defined loss function, <span class="math display">\[
L(\beta) = \|y - W\beta\|_{2}^{2} - \beta^{T} \Sigma_{uu} \beta.
\]</span> In order to find the optimal value of the regulaization parameter <span class="math inline">\(R\)</span>, we can hence use cross-validation to minimize <span class="math inline">\(L(\beta)\)</span>. This is implemented in the fucntion <code>cv_corrected_lasso</code>. We illustrate its use below.</p>
<p>For generalized linear models, we are using the conditional score approach, which does not yield a well defined loss function. Hence, cross-validation is not straightforward in these cases.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1000</span>)
<span class="co"># Generate example data</span>
<span class="kw">c</span>(X, W, y, beta, sigmaUU) <span class="op">%&lt;-%</span><span class="st"> </span><span class="kw">create_example_data</span>(n, p)
<span class="co"># Run lasso with cross-validation</span>
cv_corrected_fit &lt;-<span class="st"> </span><span class="kw">cv_corrected_lasso</span>(<span class="dt">W =</span> W, <span class="dt">y =</span> y, <span class="dt">sigmaUU =</span> sigmaUU)</code></pre></div>
<p>The result is a list of class <code>cv_corrected_lasso</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(cv_corrected_fit)
<span class="co">#&gt; [1] &quot;cv_corrected_lasso&quot;</span></code></pre></div>
<p>The print below shows all the elements of the resulting list.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(cv_corrected_fit)
<span class="co">#&gt; List of 5</span>
<span class="co">#&gt;  $ cv        :'data.frame':  100 obs. of  5 variables:</span>
<span class="co">#&gt;   ..$ radii    : num [1:100] 0.0115 0.128 0.2444 0.3609 0.4773 ...</span>
<span class="co">#&gt;   ..$ mean_loss: num [1:100] 8.74 8.45 8.16 7.88 7.59 ...</span>
<span class="co">#&gt;   ..$ sd_loss  : num [1:100] 5.54 5.33 5.09 4.86 4.64 ...</span>
<span class="co">#&gt;   ..$ upper_1se: num [1:100] 10.5 10.13 9.77 9.41 9.06 ...</span>
<span class="co">#&gt;   ..$ lower_1se: num [1:100] 6.99 6.76 6.55 6.34 6.13 ...</span>
<span class="co">#&gt;  $ radius_min: num 8.98</span>
<span class="co">#&gt;  $ loss_min  : num -3.79</span>
<span class="co">#&gt;  $ radius_1se: num 7.11</span>
<span class="co">#&gt;  $ loss_1se  : num -3.27</span>
<span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr &quot;cv_corrected_lasso&quot;</span></code></pre></div>
<p>The element <code>cv</code> contains all the details of the cross-validation runs.</p>
<ul>
<li><code>radii</code> contains all the constraint radii <span class="math inline">\(R\)</span> that were used.</li>
<li><code>mean_loss</code> contains the mean of the loss function at the given radius over all folds.</li>
<li><code>sd_loss</code> gives the standard deviation of the loss at the given radius.</li>
<li><code>upper_1se</code> and <code>lower_1se</code> contain the upper and lower standard error of <code>mean_loss</code> at the given radius.</li>
</ul>
<p>Next, <code>loss_min</code> gives the minimum of the mean loss, and <code>radius_min</code> is the corresponding radius. <code>loss_1se</code> gives the smallest loss within one standard error of <code>loss_min</code>, and <code>radius_1se</code> is a smallest radius given a loss less than or equal to <code>loss_1se</code>.</p>
<p>The result of performing cross-validation can be illustrated using the <code>plot</code> function. It shows the cross-validated loss over the grid of radii. <span class="math inline">\(R_{min}\)</span> and <span class="math inline">\(R_{1se}\)</span> are shown with labels, and the corresponing loss as horizontal red lines.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(cv_corrected_fit)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Having used <code>cv_corrected_lasso</code> to find the right value of the constraint parameter <span class="math inline">\(R\)</span>, we can use <code>fit_corrected_lasso</code> on this single value. The snippet below shows how to compute the solution using <span class="math inline">\(R_{1se}\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">corrected_fit &lt;-<span class="st"> </span><span class="kw">fit_corrected_lasso</span>(W, y, sigmaUU, <span class="dt">radii =</span> cv_corrected_fit<span class="op">$</span>radius_1se)</code></pre></div>
<p>The final parameter estimates can be found in <code>corrected_fit$betaCorr</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(corrected_fit)
<span class="co">#&gt; List of 2</span>
<span class="co">#&gt;  $ betaCorr: num [1:50, 1] -2.69 -1.13 0 1.2 1.73 ...</span>
<span class="co">#&gt;  $ radii   : num 7.11</span>
<span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr &quot;corrected_lasso&quot;</span></code></pre></div>
</div>
</div>
<div id="matrix-uncertainty-selector" class="section level1">
<h1>Matrix Uncertainty Selector</h1>
<p>The Matrix Uncertainty Selector (MUS) was introduced by <span class="citation">Rosenbaum and Tsybakov (2010)</span> as a modification of the Dantzig Selector for data with measurement error. The key insight behind the MUS, is that when <span class="math inline">\(X\)</span> is measured with error, the true coefficient vector <span class="math inline">\(\beta\)</span> may not be part of the feasible set, even when <span class="math inline">\(\lambda\)</span> is set to its theorically optimal value. The reason is that <span class="math inline">\(\lambda\)</span> is a bound on the residual of the linear model, while in the case of measurement error, a bound on <span class="math inline">\(\delta\)</span> the measurementer error matrix <span class="math inline">\(U\)</span> is also needed. The MUS is defined as the optimization problem <span class="math display">\[
\text{minimize } ~ \|\beta\|_{1}, ~ \text{ subject to }  ~ (1/n)\| W^{T} (y - W\beta)\|_{\infty} \leq \lambda + \delta \|\beta\|_{1}.
\]</span> Note that the MUS does not require an estimate of the measurement error covariance matrix <span class="math inline">\(\Sigma_{uu}\)</span>. This might be a practical advantage in some cases, when an estimate of <span class="math inline">\(\Sigma_{uu}\)</span> is hard to obtain.</p>
<p>The MUS can be converted to a linear programming problem (<span class="citation">Sorensen et al. (2018)</span>). The <code>hdme</code> package contains a function <code>fit_mus</code> for computing the Matrix Uncertainty Selector. It uses <code>Rglpk</code> (<span class="citation">(<span class="citeproc-not-found" data-reference-id="theuss2017"><strong>???</strong></span>)</span>) for solving the underlying linear program. In order to illustrate <code>fit_mus</code>, we generate som example data with measurement error.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">1</span>)
<span class="co"># Number of samples</span>
n &lt;-<span class="st"> </span><span class="dv">1000</span>
<span class="co"># Number of covariates</span>
p &lt;-<span class="st"> </span><span class="dv">50</span>
<span class="co"># Generate data</span>
<span class="kw">c</span>(X, W, y, beta, sigmaUU) <span class="op">%&lt;-%</span><span class="st"> </span><span class="kw">create_example_data</span>(n, p, <span class="dt">sdU =</span> <span class="fl">0.2</span>)</code></pre></div>
<p>We provide the measurement matrix and the response. The solution is computed over a grid of <span class="math inline">\(\delta\)</span> values, and with <span class="math inline">\(\lambda\)</span> set to the cross-validated optimum for the lasso, as chosen by <code>cv.glmnet</code> in the <code>glmnet</code> package. The returned object is a list with class <code>gmus</code>, which stands for <em>generalized matrix uncertainty selector</em>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mus_fit &lt;-<span class="st"> </span><span class="kw">fit_mus</span>(W, y)
<span class="kw">class</span>(mus_fit)
<span class="co">#&gt; [1] &quot;gmus&quot;</span>
<span class="kw">str</span>(mus_fit)
<span class="co">#&gt; List of 6</span>
<span class="co">#&gt;  $ intercept   : num [1:26] 0.0195 0.0195 0.0195 0.0195 0.0195 ...</span>
<span class="co">#&gt;  $ beta        : num [1:50, 1:26] -1.89 -0.976 0.438 0.92 1.917 ...</span>
<span class="co">#&gt;  $ family      : chr &quot;gaussian&quot;</span>
<span class="co">#&gt;  $ delta       : num [1:26] 0 0.02 0.04 0.06 0.08 0.1 0.12 0.14 0.16 0.18 ...</span>
<span class="co">#&gt;  $ lambda      : num 0.0257</span>
<span class="co">#&gt;  $ num_non_zero: num [1:26] 24 11 5 9 4 2 2 2 2 2 ...</span>
<span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr &quot;gmus&quot;</span></code></pre></div>
<p>The default plot method shows the number of nonzero coefficients along the grid of <span class="math inline">\(\delta\)</span> values chosen by the algorithm.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(mus_fit)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>According to the “elbow rule” (<span class="citation">Rosenbaum and Tsybakov (2010)</span>), a final value of <span class="math inline">\(\delta\)</span> can be chosen where the curve starts to level off. This is not always easy in practice, but in the plot above, a value between <span class="math inline">\(0.05\)</span> and <span class="math inline">\(0.1\)</span> may be reasonable. Choosing <span class="math inline">\(1.0\)</span>, we can call the algorithm again, but this time setting the argument <code>delta = 0.1</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mus_fit &lt;-<span class="st"> </span><span class="kw">fit_mus</span>(W, y, <span class="dt">delta =</span> <span class="fl">0.1</span>)</code></pre></div>
<p>Since only one value of <span class="math inline">\(\delta\)</span> was provided, the plot method will now show all the estimated coefficients, rather than the number of nonzero coefficients, as in the previous plot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(mus_fit)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAEgCAMAAABrWDzDAAABF1BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrYzMzM6AAA6ADo6AGY6OgA6OmY6ZmY6ZpA6ZrY6kLY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmOgBmOmZmZgBmkJBmkNtmtrZmtttmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2OyP+QOgCQZgCQZjqQZmaQkDqQkGaQkLaQtpCQttuQ2/+rbk2rbm6rbo6ryKur5OSr5P+2ZgC2Zjq2kDq2tpC2ttu229u22/+2/9u2///Ijk3I///bkDrbtmbbtpDb27bb29vb/7bb/9vb///kq27k///r6+v/tmb/yI7/25D/27b/5Kv//7b//8j//9v//+T///+cz9++AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAOcUlEQVR4nO2dC3/bthXFKSepoqRrNylNnGzroiyr087ao2uVrovWrqltpVvnZLJiW+b3/xwD+BYJkRJAXBBX5/wSSxTv1Tky/wZB6hWEEGSgwHUAyG8BIMhIAAgyEgCCjASAICMBIMhIAAgyEgCCjLQbQPMgUb9w4/LXJ+Fqcud8Y5csKGs16Ssqq/qn8DoXPz54UjDY6KZygqyqBYDmBw0AyYKytgRoIb3kjw8m2wCkcoKsakeAVBuocasZATROfmwlAEQufYBWfw6C3lNBghgfhnJMWA6Gbwa9T8PFIPhYDhBvPhQFnyYFYfj+SRD84rXsfDMIbv+QAyQXp/KKrLj9Or0ma2ei9eA38seP0aCTlMYjUFoklr7/sOCUBINIpA1QtLWCYFwE6KOB2HRfDeJdXLK7SwrCpbw56E2TFbefpAAt0tsXWUVWWwIoLY0AyoqSJHmUeKnN3xK0UXpzILHZloNfyo3Yz+dAYos+Dd/EsNw5X00OXofFAjko/CQWrw57X4fvJ+k0SqyYiq6h5OCpdJCtaW2+C5MGhdJikWjsn4vGxCkPBhHIAKBbv/0hvjEDSGy0q0MxOCST3P98/5dBvlmHSW18LdvCyYrslllvmteuA5SVFhZEkUD1RBpnTmkwiED6cyC5ewk+fl0EaJhsx3CW7WJSgBYZevGUOJtELwfjtSsLWZFhWgIoKZULeVGMa3SHUb4sGEQgg6Own57IycnJBoCuDoOP/vavnw/pAcqCQQQyO4z/95/EtlUDFG/tbA6UbfxknxXXhRt2YdkMuG4XlhZVAEqDQQTSBmgR/EpMdr4To8Q8OS4qAyRmtuJIW2zcuEBMncXc+eBETKKjg//iJHp5KGfFhUl0UquYRMelxaIiQNGglQaDCKR5JlputuiK5CM/D1QAKD24TgrSfdgwOW4vHcZHnGSH8cXaAkBZaWEhOSZLAcoP42vOjEMtShug+HydOGIOr54E/f9WJ9HRacGvZ6JSFohJtVi+FZ3fE3OU2z+unUiMz/stsxOJWe06QGlpvJAWFQCKnLJgEIHwbDxkJAAEGQkAQUYCQJCRABBkJAAEGQkAQUYCQJCRdgLof2sqLTZq13r7DUikXw+AKAwYJwJAFAaMEwEgCgPGiQAQhQHjRACIwoBxIgBEYcA4ET1AQRC0lL21Bn82l7uGVgEyUfQ6NCoziExkI1AEUDvwt9bgz9+7u4bO7MIAUCcM/AUIc6BOGHgMkEe/HHcN/iQCQBQGjBMBIAoDxokAEIUB40QAiMKAcSIARGHAOBEAojBgnAgAURgwTgSAKAwYJwJAFAaMEwEgCgPGiQAQhQHjRACIwoBxIgBEYcA4EQCiMGCcCABRGDBOBIAoDBgnAkAUBowTASAKA8aJABCFAeNEAIjCgHEiAERhwDgRAKIwYJwIAFEYME4EgCgMGCcCQBQGjBNtD9Dl8zMARNXgT6KtAboYfQKAyBr8SbQtQKcPvsUIRNfgT6Kdd2F3hRprob0T5kCdavAnEQCiMGCcCABRGDBOBIAoDBgnAkAUBowTbQ9QQXaiuGtAIv16AERhwDgRAKIwYJwIAFEYME4EgCgMGCcCQBQGjBMBIAoDxonUAM2DYDy/cw6AXDX4k0gJ0OzOz4fj1aQPgFw1+JNIBdDV4Vj8CxcHJwDIUYM/iQAQhQHjRMpd2Fzuwq4Oh9iFuWrwJ5ESoHAhvxVuIz8ACIny25UANchOFHcNSKRfD4AoDBgnUgF0dRh9sWmASbSzBn8SbR6Brh5PMQK5avAnUc0ubLHxVLSdKO4akEi/vg4g7MKcNfiTqAagGUYgZw3+JFIBlEyie5gDOWvwJ1HNCLRZdqK4a0Ai/XoARGHAOFEFoPQkEM4DuWzwJxHZCCSA1IyOzdWFBtcARUOaXnRsri407ATQctD6LgwAdcvAKkCryXA1iV5T1p4igFq8P6hjKr0iMZwNW34qA3OgThlYPpE4Dud9PJXhsMGfRCqAwllEz+b39diJ4q4BifTrlQCJSVA4w1MZDhv8SaQEqEl2orhrQCL9egBEYcA4kQqgmjf0ACCaBn8SKUeguTjmrjsJZCeKuwYk0q9XAiQ0w+uBXDb4k2gTQJIhnAdy1uBPopoRaCM/AAiJ8ttVANXuvwAQEhVvVwDU+DSqnSjuGpBIv37TLgwAOW3wJxEAojBgnAgAURgwTgSAKAwYJ1IBlEyi8Xogdw3+JAJAFAaME1UBmmfvC8PH/Dpr8CdRzQi0WXaiuGtAIv16FUCNshPFXQMS6dcrAbLwvjCDemyuLjTsAlDNlxwAIJoGfxKpAMIcyHmDP4nUIxAActzgTyIVQDVngAAQTYM/iVQA4XOinTf4k0g5AjXJThR3DUikX78tQNcvRg/fASCqBn8SqQGqfOXlzcvj8O2j3QHKP5NDUZ+vVFyrXbllWRv3gUSlm0pSAlT9ysvrL87Cy+dnuwJU+Fipan2+UnGtduWWZW3cBxKVyspSAaT4xsLLz96F15+/EtfuCjXs7nJFvs0rFddqV25Z1sZ9IFGpbJMaALp4mAIkVWJQSWaJZUV9vlJxrXbl/vy9dy9RWSqAFF95mY9AOwGk3HViDtSlsp3voyQlQNWvvNScA6ktd6zHMU8XGgwP429eHmkdhbURHZurCw04D+TSgHGiCkDRDDqaM+GpDHcN/iTadgQCQKQN/iQCQBQGjBMpAZKf0lr3skQ7Udw1IJF+vRKgWT+sfWGrnSjuGpBIv14FEN5Y6LzBn0QAiMKAcSLlLmwu0an5sF87Udw1IJF+vRKg6lMZAIi2wZ9EaoAaZCeKuwYk0q8HQBQGjBNVAMJTGV1o8CcRRiAKA8aJ1CMQ3pnquMGfRACIwoBxououLP+EMsyBnDX4k6gKED6dowMN/iTCLozCgHEiAERhwDhRdReGOVAHGvxJVAUIc6AONPiTSAVQo+xEcdeARPr1aoAqn84BgGgb/EmkBKj66RwAiLbBn0QqgBQfrgCAaBv8SQSAKAwYJ1LuwqqfzgGAaBv8SaQEqOklrRBUFg7jO9XgTyIrAG38NCKt6NhcXWjY+TyQwbsyNn8emlZ0bK4uNOw2iTZ7XxgAMm7wJ5EKINN3pgIg4wZ/EtkACHMg4wZ/EtnYhbUcHZurCw2Uk+iWo2NzdaGB9DC+3ejYXF1oAEAuDRgnUgAUzaFXk80vBwJASJTfXgFoOYgnP7PN33tpJ4q7BiTSr68CNOuXrwAg8gZ/ElUAyl9Rj9cDuWvwJxEAojBgnKgCkPyM6FibX1VvJ4q7BiTSr68AFJ+GXiMJAJE3+JOoClA4602jXRne1uOuwZ9ECoDEgXwQBBFFAMhRgz+JVAA1yk4Udw1IpF8PgCgMGCcCQBQGjBMBIAoDxokAEIUB40QAiMKAcSIARGHAOBEAojBgnAgAURgwTgSAKAwYJ9oeoMvnZwCIqsGfRFsDdDH6BACRNfiTaFuATh98ixGIrsGfRDvvwu4KNdZCeyfMgTrV4E+iLQA6HY0eASDaBn8SYQSiMGCcCABRGDBOBIAoDBgn2h6gguxEcdeARPr1AIjCgHEiAERhwDgRAKIwYJwIAFEYME4EgCgMGCcCQBQGjBMBIAoDxokAEIUB40QAiMKAcSIARGHAOBEAojBgnAgAURgwTgSAKAwYJwJAFAaMEwEgCgPGiQAQhQHjRACIwoBxIgBEYcA4EQCiMGCcCABRGDBOBIAoDBgnAkAUBowTASAKA8aJ2gQoCAIb0bG5utBAAJD8rvltCPLnl+OuwZ9EAIjCgHEiLYDUigAyvxvIS2EO1KkGfxK1CZCl6NhcXWgAQC4NGCcCQBQGjBMBIAoDxokAEIUB40QAiMKAcSItgNZl/XPH/Tdg8BCaDACQ3w7ODQCQ3w7ODQCQ3w7ODfAkFmQkAAQZCQBBRgJAkJEAEGQkXYCuX4wevms1ybqir3ixZ3L5bDQ6tvooLkbRl83a/D3dvLT6EN6OoofQYKAJkMz+9pFe7zaKvurXnsn156/Cy9+/svgo5B+AuGurv6e34m/AosHpsfzZZKAJ0PUXZ8XvgWpb8Vf92jO5kL+R02PLj0LctU2Hyz/88dji7+jmm1fyoslAE6DLz95Ff8bWJDPbNRH3bPlRiD9ciw433/xDDA72DMSuS+7mmww0Abp4SACQVZObl0d2DS6fPXhl0+Htkdy72DMQu3g5CjUZ7OsIdP3iyPqjsDrGiXu+sToCRTo9tjQCWZ49xABZNLl8JmeIth+FzVmWPEYajY5sT0YbH4H2UdiR1aOwKLM9k5gfm48iGfmt/p7kCGTPQD6Cm7+fNRns53mg+M/32OajEBZiDuT5eaAtHgHORENGAkCQkQAQZCQABBkJAEFGAkCQkQAQZCQABBlpXwGaB0HQmypX9Kbi/1f3spXLe9W696+bLVR9/LSfAK0md84lK+PKmqvDcfS/XluxAYD4aib5EQTFF0XJrd685QFQpr0EqDjErCZB0E8uD06WgyC4Jf735dZPVqVXD07E1a/EyrGsGsrmZDlmRfyIl4fL5MYvg0Aimjbf/6u8YKa9BKgwNqwm/ey/HJHSEUj8lzdJ1JKr0dqBAGIuOEvuYG1ZAhQtB8mNYmHtrgd9Z4/YnvYToPvZQLCQY4L4EV0KXAoAZZTcm2ZrB+NwbVVxOQJoXLgxuVxrZqf9BCgfgRZyHyOW59GnXYu9Tw7QItnflNaW2FoHKLmMF+7H4Kw1s9NeApTOga4eTzOAkvn0BoAKa3cHqNjMTnsJUHr4JSYqC3kyaJFchmsAFXdhPQUw5eUKQMnlWjM77SdA+XmgfBItbhGbujSJlv+jq/lauZwOYfnyUJT2SgBlk+hCMzvtJ0BhOEvPRBcP43vT4ghUPoxP1kY/ZlFPviwP3H/3uDwCfVm5a37aV4CglgSAICMBIMhIAAgyEgCCjASAICMBIMhI/wcxKdzbZXo6nwAAAABJRU5ErkJggg==" /><!-- --></p>
<div id="generalized-matrix-uncertainty-selector" class="section level2">
<h2>Generalized Matrix Uncertainty Selector</h2>
<p>The Generalized Matrix Uncertainty Selector (GMUS) is an extension of the MUS to generalized linear models, introduced by <span class="citation">Sorensen et al. (2018)</span>. It is defined as the solution to the optimization problem</p>
<p><span class="math display">\[
\text{minimize } ~ \|\beta\|_{1}, ~ \text{ subject to } ~ (1/n)\|W^{T} (y - \mu(W \beta))\|_{\infty} \leq \lambda + \sum_{r=1}^{R}\delta^{r}(r! \sqrt{n})^{-1} \|\beta\|_{1}^{r} \|\mu^ {(r)}(W\beta)\|_{2},
\]</span> where <span class="math inline">\(\mu(\cdot)\)</span> is the vector valued mean function of the generalized linear model and <span class="math inline">\(\mu^{(r)}(\cdot)\)</span> is its <span class="math inline">\(r\)</span>th derivative. <span class="math inline">\(R\)</span> is a parameter controling the number of Taylor expansion terms which are included. When <span class="math inline">\(R\to\infty\)</span>, the true solution is a member of the feasible set given that the bounds <span class="math inline">\((1/n)\|W^{T}\epsilon\|_{\infty} \leq \lambda\)</span> and <span class="math inline">\(\|U\|_{\infty} \leq \delta\)</span> hold. In practice, we set <span class="math inline">\(R=1\)</span> for computational reasons. When <span class="math inline">\(R=1\)</span>, the GMUS can be solved using a sequence of linear programming problems on the same form as the MUS, with an iterative reweighing algorithm.</p>
<p>The <code>fit_gmus</code> function in the <code>hdme</code> package implements the GMUS for <span class="math inline">\(R=1\)</span>, which is defined as <span class="math display">\[
\text{minimize } ~ \|\beta\|_{1}, ~ \text{ subject to } ~ (1/n)\|W^{T} (y - \mu(W \beta))\|_{\infty} \leq \lambda + \delta n^{-(1/2)} \|\beta\|_{1} \|\mu^ {(1)}(W\beta)\|_{2}.
\]</span> As the MUS, the GMUS does not require an estimate of <span class="math inline">\(\Sigma_{uu}\)</span>.</p>
<p>We illustrate <code>fit_gmus</code> using logistic regression. First, we generate some sample data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">323</span>)
n &lt;-<span class="st"> </span><span class="dv">100</span>
p &lt;-<span class="st"> </span><span class="dv">50</span>
<span class="kw">c</span>(X, W, y, beta, sigmaUU) <span class="op">%&lt;-%</span><span class="st"> </span><span class="kw">create_example_data</span>(n, p, <span class="dt">sdU =</span> <span class="fl">0.2</span>, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
gmus_fit &lt;-<span class="st"> </span><span class="kw">fit_gmus</span>(W, y, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</code></pre></div>
<p>The returned object is again a list with class <code>gmus</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(gmus_fit)
<span class="co">#&gt; [1] &quot;gmus&quot;</span>
<span class="kw">str</span>(gmus_fit)
<span class="co">#&gt; List of 6</span>
<span class="co">#&gt;  $ intercept   : num [1:26] -0.588 -0.322 -0.257 -0.225 -0.204 ...</span>
<span class="co">#&gt;  $ beta        : num [1:50, 1:26] -3.15 -1.33 0.91 1.66 2.74 ...</span>
<span class="co">#&gt;  $ family      : chr &quot;binomial&quot;</span>
<span class="co">#&gt;  $ delta       : num [1:26] 0 0.02 0.04 0.06 0.08 0.1 0.12 0.14 0.16 0.18 ...</span>
<span class="co">#&gt;  $ lambda      : num 0.00926</span>
<span class="co">#&gt;  $ num_non_zero: num [1:26] 21 15 17 9 8 4 7 3 9 6 ...</span>
<span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr &quot;gmus&quot;</span></code></pre></div>
<p>The model fitting works the same way as for the MUS. A <span class="math inline">\(\lambda\)</span> value is found by running the lasso with the appropriate link function, and taking the value yielding minimum cross-validation loss. A range of <span class="math inline">\(\delta\)</span> values are tried. We can call the <code>plot</code> function to study the behavior.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(gmus_fit)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Again we see that the number of nonzero coefficients decreases in <span class="math inline">\(\delta\)</span>. Following the elbow rule, a reasonable choice for <span class="math inline">\(\delta\)</span> might here be <span class="math inline">\(0.1\)</span>. To obtain a final estimate, we might therefore run <code>fit_gmus</code> again with this value.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">gmus_fit &lt;-<span class="st"> </span><span class="kw">fit_gmus</span>(W, y, <span class="dt">delta =</span> <span class="fl">0.1</span>, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</code></pre></div>
<p>The plot will now show the estimated coefficients.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(gmus_fit)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="poisson-regression" class="section level3">
<h3>Poisson Regression</h3>
<p>The Generalized Matrix Uncertainty Selector is also implemented for Poisson regression. Use the argument <code>family = &quot;poisson&quot;</code> to <code>fit_gmus</code>.</p>
</div>
</div>
</div>
<div id="generalized-matrix-uncertainty-lasso" class="section level1">
<h1>Generalized Matrix Uncertainty Lasso</h1>
<p>A “lasso equivalent” of the Generalized Matrix Uncertainty Selector can also be defined (<span class="citation">Rosenbaum and Tsybakov (2010)</span>, <span class="citation">Sorensen et al. (2018)</span>). We refer to <span class="citation">Sorensen et al. (2018)</span> for the details of this algorithm.</p>
<p>This GMU Lasso is implemented in <code>hdme</code>, and can be called with the function <code>fit_gmu_lasso</code>. The snippet below shows its use. The underlying coordinate descent algorithm is implemented in <code>C++</code> using the <code>RcppArmadillo</code> package (<span class="citation">Eddelbuettel and Sanderson (2014)</span>). Both logistic and Poisson regression are supported, with arguments <code>family = &quot;binomial&quot;</code> and <code>family = &quot;poisson&quot;</code>, respectively.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">set.seed</span>(<span class="dv">323</span>)
n &lt;-<span class="st"> </span><span class="dv">100</span>
p &lt;-<span class="st"> </span><span class="dv">50</span>
<span class="kw">c</span>(X, W, y, beta, sigmaUU) <span class="op">%&lt;-%</span><span class="st"> </span><span class="kw">create_example_data</span>(n, p, <span class="dt">sdU =</span> <span class="fl">0.2</span>, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)
gmu_lasso_fit &lt;-<span class="st"> </span><span class="kw">fit_gmu_lasso</span>(W, y, <span class="dt">family =</span> <span class="st">&quot;binomial&quot;</span>)</code></pre></div>
<p>The returned object is a list with class <code>gmu_lasso</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">class</span>(gmu_lasso_fit)
<span class="co">#&gt; [1] &quot;gmu_lasso&quot;</span>
<span class="kw">str</span>(gmu_lasso_fit)
<span class="co">#&gt; List of 6</span>
<span class="co">#&gt;  $ intercept   : num [1:5] -0.591 -0.283 -0.224 -0.195 -0.177</span>
<span class="co">#&gt;  $ beta        : num [1:50, 1:5] -3.325 -1.382 0.897 1.769 2.799 ...</span>
<span class="co">#&gt;  $ family      : chr &quot;binomial&quot;</span>
<span class="co">#&gt;  $ delta       : num [1:5] 0 0.05 0.1 0.15 0.2</span>
<span class="co">#&gt;  $ lambda      : num 0.00926</span>
<span class="co">#&gt;  $ num_non_zero: num [1:5] 13 8 5 4 4</span>
<span class="co">#&gt;  - attr(*, &quot;class&quot;)= chr &quot;gmu_lasso&quot;</span></code></pre></div>
<p>The plotting function gives an elbow plot, which can be used to select the regularization parameter <code>delta</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">plot</span>(gmu_lasso_fit)</code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAkAAAAEgCAMAAABrWDzDAAAA51BMVEUAAAAAADoAAGYAOjoAOmYAOpAAZrYzMzM6AAA6ADo6AGY6OgA6OpA6ZmY6ZpA6kLY6kNtNTU1NTW5NTY5NbqtNjshmAABmADpmOgBmOmZmtrZmtttmtv9uTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+QOgCQkGaQtpCQ27aQ2/+rbk2rbm6rbo6rjk2ryKur5OSr5P+2ZgC2kDq22/+2/7a2///Ijk3I///bkDrb/7bb///kq27k///r6+v/tmb/yI7/25D/27b/29v/5Kv//7b//8j//9v//+T///9TCgLYAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAQBklEQVR4nO2dCXcbtxWFR0rFyukmOjabtnYSy3ErpZXTpmJcyaxkU0xJUfP/f08Hs3CdDXhY3gPvPccWRc81Hp4+YZshkKQQRFASOgBItgAQRBIAgkgCQBBJAAgiCQBBJAEgiCQABJGkDdAkKTVIl5cnd4vRQMuuPBvfzv50oxsAxEqBAZocAyDZ0gdo/SMHQJANgKanya8+qO9/+TpRrwpGJsmZuqLAazE6U1ddVQCtrsxasjNrdYECiA7QF6cZBUcZG1P1Qr2aqO/GWR+Xzk4LPBaj35VX5QBVVwIg+TIeA5UwLEbJH+6WP+cjouQv6p9P7manrzJkkoy0qUIpVQAlg+qqk7v1lejCxIsOkOqSlpfHN7PTvLsaH12pcdHs2Q/ZFeNywFNclY6Pb5RnfSUAEi96F5Z3QVmvpdqdTNOCm+nxf0avyn9UAA3KqwqAVlcCIOlyAlD2ZzzIBtDlWwAoYtmZxm93YdnY+c+XZ+nk5Ofq2nVHhy4sMtEByqZRO4Po7OUXz1Q79JtqjWhzqL09iC5H2ZBUma9EF61JOUFXVK2m8eqi7I3ZaVL2YGk52c/e3JrG5/8bpvGiRQdILRH+Nl9InBXLg5mmahFI9VilqVhu/P2HaiFxdeXi62x+b682kHf5uRuve8MDEiMABJEEgCCSABBEEp5IhEgCQBBJAAgiCQBBJAEgiCQABJEEgCCSdAH6XK+m9/uI4BVnlRdx408cAIWwyosYALGyyosYALGyyosYALGyyosYALGyyosYALGyyosYALGyyosYALGyyovYNkANwoL2ocpWC5TYZzxGq7yIvXVh5gTxSoxbq7yI/Y2BjAnilRi3VnkRexxEJ4YI8UqMW6u8iL3OwswI4pUYt1Z5EfudxhsRxCsxbq3yIva8DmRCEK/EuLXKi9j3QqIBQbwS49YqL2LvK9H6BPFKjFurvIj938rQJohXYtxa5UUc4F6YLkG8EuPWKi/iEDdTNQnilRi3VnkRB7kbr7ekyCsxbq3yIg4CkF4jxCsxbq3yIg4EkA5BvBLj1iov4lAAaRDEKzFurfIiDgZQf4J4JcatVV7E4QDqTRCvxLi1youYBtD824/ZX6+HwwsDgPoSxCsxbq3yIiYB9DD86mP6+P11Ov/m2gCgngTxSoxbq7yIKQDdPv8pa4EeXqqXVROkV0wvgnglxq1VXsQWurBMqhVK019nar18Xwk+rhG5egH09P68ekcb8e5GiNdvllurvIhttECPb1f86APUTRCvxLi1yovYyizsYv2OQYRdBPFKjFurvIjpAG3xYwJQF0G8EuPWKi9iOkD3QyWzWVipdoJ4JcatVV7EAVeiN9RKEK/EuLXKi5gHQK0E8UqMW6u8iLUAWqij3pPWg5RNI2whiFdi3FrlRawF0HigDmWetJ3tZRxh81OKvBLj1iovYh2AsgZoeTlIp21NECHCJoJ4JcatVV7EmgAtRmfOAGoiiFdi3FrlRawD0PLybHp0pToyNwA1EMQrMW6t8iLWGgPNTpNBOj5pO8idFmEtQbwS49YqL2Im0/hKdQTxSoxbq7yINcdA6ouzMZBSDUG8EuPWKi9ibgDVEMQrMW6t8iLuD9AkqeRsEJ1rjyBeiXFrlRexQQvUKgsR7i4p8kqMW6u8iJkNogttE8QrMW6t8iLWncYrOR0D5doiiFdi3FrlRay3kNg2+rEqPGsfiwKMgXJttEG8frPcWuVFrNcC+QNogyBeiXFrlRex1hiodQXIMkBrgnglxq1VXsR60/jE0yA6V0UQr8S4tcqLmOU0vlRC8Aq1youYM0DlkiKvxLi1yotYD6BJkryaOHycY08JwSvRKi9iLYDGJ/8tnmr1BpAiiFdi3FrlRax5L0wtBbm9G7+rhFli3FrlRcweoM8Jr8S4tcqLWKsLm6guTD1X7xMgwmmrzHLKt1hvg+ipWgZq48cFQIQTn3nllG+xsU7jK+/hnNcrL2IRABkTxCunfIv1AVDxuXiftzI2vYYnPvPKKd9io2+BPh/Keb3yIhYD0GGc1ysvYi2Alpdn248l5nskPr4dvvjkHqCDOK9XXsR6tzIG6daDrflO9U/vL9L7lx4AOoTzeuVFrLkSrb6sVqKLneof331cbTjuFqADOK9XXsQUgMpdWt98Mt+pXlN41l6ctm9lKHQ2b2UogB5eVAAp2Ud8yxv7eb3yIqbdythugTwApEkQr5zyLTbYNH7udwykpLWkyCunfIsNCpA6acXPLKxUzOf1youYdivD6zrQShGf1ysvYjkr0RuK97xeeRHrtUAeP5na6o32vF55EcsEKNrzeuVF3L8LW+9QFuBxjj1Fel6vvIgNVqI5tECxntcrL2KhXdjnfgTxyinfYg8SoD5LirxyyrfYAxwD5YrvvF55EYsdA+WK7rxeeRGLXEhcK7bzeuVFrAeQ9905Or2RndcrL2ItgALsztHpjeu8XnkRa46BAmyu0OWN6rxeeRHLByiq83rlRazVhYXZnaPT20wQr5zyLdbbIDrM7hydVzQuKfLKKd9iGU3jA0lImAco5utAK0VyXq+8iLXXgTh2YUpxnNcrL2K9QfTu58IYARTHeb3yIja4F8ZtGl8phvN65UUcEUAxnNcrL+J4urDPMZzXKy/iaAbRuXYJ4pVTvsUyWgeyH6GWd2dJkVdO+RYLgNaSfV6vvIi1ANrb4o4hQFsE8cop32J9AbS7xR1LgESf1ysv4pim8ZUEn9crL+IYARJ8Xq+8iKNaB1pJ7Hm98iLWm4UxfR5oX1LP65UXcXTT+FIJtVgARLNKB6hYUuSVU77FhgVo/lptWM8NIJnn9cqLmA6Q2uL3frVJov0Izb0Cz+uVFzEdoHyf6HfetvnVkbzzeplRQLCatEDujzrQFZ61D64ej3N43+ZXw2p40iGxVHMrs2aEYK0FqHYhcf7NdfrwFcsuTFlNEQJANGsdQPW3MrwetmJiNUMIANGs/QFi3gIpmSAEgGjW/l1Y+jAcPq8aIJ4AmSAEgGjWWoDYPxPdYtUlCADRrPUAdct+hLZqp9kIASCatQ6g5SW3TTb1rAKOGmNGAcFaBxC/XVp1rRoIASCatQ6gtH1/TQEAaSAEgGjW+haI2UbjRtaeCAEgmrW2Beoh+xHar10vhAAQzRozQL3m9ACIZq0HiN9G44bW7kYIANGstQBx3Gjc1NqFEACiWesAYrpPtKm1HSEARLMeAEDtCAEgmrW2C2O60TjB2owQAKJZawGS88HC/lZee5Qzo4BgrQeoW/YjdJ2YhkYIANGshwNQA0IAiGatA2gxyifwrYNomUrw8Q1X2rkXptiJZxa2ob1WCC0QzVoL0B+vxklM0/gtsdifkxkFBGt9C/QqnSSD2ZdRArSDEACiWZsASmenwh/naFPw7RWZUUCwNgKULi/jBWijEQJANGsdQH1kP0LPiUmCbm7GjAKC9WABqhACQDRrLUDZ+Ef+I609lATbm4oZBQRrHUAdm9THA5BCCADRrHUAyf9Yj4aM94WRWFlvLdABARRmayFmFBCsdQD1uQtmP8JwiQmwtRAzCgjWOoDi+FyYjtX71kLMKCBYa1ugHrIfYdjEeN5aiBkFBCsAql543VoodGXtWesBErw/EMHqcWuh8JW1Za0FSMxpPZat/rYWYlBZS9Y6gBrOC3t6z3+LO6rV19ZCLCprxaoB0O1FvlNr1AD52lqISWUtWPt3YetjDqIGyM/WQmwqS7bWAlQ7iJ6/+VfZhfE76sCy8Oy9vnoctvL6Ij9wpZB9xFn9ZrneWohVZUlWDYDeMN+p3q7V7dZCzCpLsO4BVN3H2LuV8fi3gwLI7dZC3Cprbm1ugca7g6DbA+rCcjncWohfZU2tTQAtRkdXO289vuV55KVDq7OthThW1szaANA06djp136EzBJTytHWQjwra2KtB2icdD3Uaj9CZolZycnWQlwrq2+tA2h5mXQ+kmg/QmaJ2ZCDrYX4VlbXWgPQ7LTHthz2I2SWmE3Z31qIcWU1rfsATTq7r4MDyP7WQqwrq2XdA6hxHeigAapFKN7KalhrurBesh8hs8Tsy+bWQuwr29sKgDSutbe1kIDK9rQCIK2rbW0tJKKyvawASPN6O1sLCalsDysA0jVY2VpISmW7rQBI32JhayE5le2yAiATE3lrIUmVbbcCIDMbcWshWZVtswIgUyNpayFplbUPEKSevUfWVkILZGQt7vl4L5aRFQBZsBpQJLeyu+8DIEtWPYo4RGzFCoCsWnt3aWwiploBkANrD4qYRWxuBUCurO2NEceIjawAyK21iSK+EWtaAZAHaw1FzCPubwVAvqzbXZqEiHtZAZBfa0WRnIg7rAAogNV4/ZpWLACKx7q6DeK3WAAUi3XlNWiMeFUWAAWxUm6D8KosAApibbwN4rZYABSLtdHbo0vjVVkAFMTa5zaIg2IBUCzWPt6mxohXZbUAenp/AYCsWCm3QXhVVgug+yEAsmM1uQ1iodjAAM2/+ysAsmM18VZdGq/KagD09OO/iy4s+qMOOCsJpM64ukO/P8cYyJZVXsT0Fmj+5hMAsmWVFzEdoPuh0jkAsmGVFzGm8ays8iIGQKys8iLGSjQrq7yIARArq7yIARArq7yIbQPUoEALjGGKRWU3BICklMq0sgBISqlMKwuApJTKtLLYrA0iCQBBJAEgiCQABJEEgCCSKAA9vh2++LT5av2GS+0Vqx44WZ9s77zUNJ1/+9F/ZctiPVd2/nqoHohvriwBIHWP/v7lxqv1Gy61V2x6e9HlsVlqmj6on6DvypbFeq7s4/fX6fyb65bKEgB6fPex+KWoXq3fcKm9Yp9+vHZc5Fap6e3zn7IXvitbFuu5sg+KmtuLlsoSAJq/+ZQTunq1fsOl9orNmtfh0PXv5VbdVC59V7Ys1n9lO36yBIAeXlT/a/lq/YZL7RWbNbHufzG36qZ+kr4rWxbrv7JP78/bKhtBC5S/63powKUFyuWzso9vz3ebpC1FMAbK33Wd0626zUOMgTwCtFHq/PXFbhjbIs3CzlfTofNiFnbuZWKyU6xqX5/+6fhHuVU3lUvflU3XPafHyhb8tFWWvg5UDu18rwNtFHs/HD53PjdZlxpgHWijWL+VLT7TdeFmHQiCABBEFACCSAJAEEkACCIJAEEkASCIJAAEkQSAemp6fFO9nD27Sn/5EDIYRgJAPbUNkGIIUgJAPQWA6gWAemgxSo5+yABaXiZJ9mX27O+nSXKWzrK/sy+HLQDUrcXoLPtzfLO8HKTp5OSubIEWo1fZt+uG6TAFgLqV914ZKfnXDJsSoP/dpcWA+qAFgLqVNToZKV/eTIqtt89WY6Bp9t0RAII6tAJIfU1Xg+jFKIMHLVDoAAQo77qyv6Zla1MCNFU8TdECQV1ajAblIDpDJiMmo0cNoBU7s1MABHVqcxpfdlvjZJD9SY7+oaZihywABJEEgCCSABBEEgCCSAJAEEkACCIJAEEk/R+ohy3lSsIbcwAAAABJRU5ErkJggg==" /><!-- --></p>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-buhlmann2011">
<p>Bühlmann, Peter, and Sara van de Geer. 2011. <em>Statistics for High-Dimensional Data</em>. Springer Series in Statistics. Springer, Heidelberg.</p>
</div>
<div id="ref-candes2007">
<p>Candes, Emmanuel, and Terence Tao. 2007. “The Dantzig Selector: Statistical Estimation When P Is Much Larger Than N.” <em>Ann. Statist.</em> 35 (6). The Institute of Mathematical Statistics: 2313–51.</p>
</div>
<div id="ref-carroll2006">
<p>Carroll, Raymond J., David Ruppert, Leonard A. Stefanski, and Ciprian M. Crainiceanu. 2006. <em>Measurement Error in Nonlinear Models: A Modern Perspective, Second Edition</em>. Boca Raton, FL, USA: Chapman &amp; Hall/CRC.</p>
</div>
<div id="ref-eddelbuettel2014">
<p>Eddelbuettel, Dirk, and Conrad Sanderson. 2014. “RcppArmadillo: Accelerating R with High-Performance C++ Linear Algebra.” <em>Computational Statistics and Data Analysis</em> 71 (March): 1054–63.</p>
</div>
<div id="ref-hastie2009">
<p>Hastie, Trevor, Robert Tibshirani, and Jerome Friedman. 2009. <em>The Elements of Statistical Learning: Data Mining, Inference and Prediction</em>. 2nd ed. Springer.</p>
</div>
<div id="ref-james2009">
<p>James, Gareth M., and Peter Radchenko. 2009. “A Generalized Dantzig Selector with Shrinkage Tuning.” <em>Biometrika</em> 96 (2): 323–37.</p>
</div>
<div id="ref-flare_package">
<p>Li, Xingguo, Tuo Zhao, Lie Wang, Xiaoming Yuan, and Han Liu. 2014. <em>Flare: Family of Lasso Regression</em>.</p>
</div>
<div id="ref-loh2012">
<p>Loh, Po-Ling, and Martin J. Wainwright. 2012. “High-Dimensional Regression with Noisy and Missing Data: Provable Guarantees with Nonconvexity.” <em>Ann. Statist.</em> 40 (3). The Institute of Mathematical Statistics: 1637–64.</p>
</div>
<div id="ref-rosenbaum2010">
<p>Rosenbaum, Mathieu, and Alexandre B. Tsybakov. 2010. “Sparse Recovery Under Matrix Uncertainty.” <em>Ann. Statist.</em> 38 (5): 2620–51.</p>
</div>
<div id="ref-simon2011">
<p>Simon, Noah, Jerome Friedman, Trevor Hastie, and Rob Tibshirani. 2011. “Regularization Paths for Cox’s Proportional Hazards Model via Coordinate Descent.” <em>Journal of Statistical Software</em> 39 (5): 1–13.</p>
</div>
<div id="ref-sorensen2015">
<p>Sorensen, Oystein, Arnoldo Frigessi, and Magne Thoresen. 2015. “Measurement Error in Lasso: Impact and Likelihood Bias Correction.” <em>Statistica Sinica</em> 25 (2). Institute of Statistical Science, Academia Sinica: 809–29.</p>
</div>
<div id="ref-sorensen2018">
<p>Sorensen, Oystein, Kristoffer Herland Hellton, Arnoldo Frigessi, and Magne Thoresen. 2018. “Covariate Selection in High-Dimensional Generalized Linear Models with Measurement Error.” <em>Journal of Computational and Graphical Statistics</em>. Taylor &amp; Francis.</p>
</div>
<div id="ref-stefanski1987">
<p>Stefanski, Leonard A., and Raymond J. Carroll. 1987. “Conditional Scores and Optimal Scores for Generalized Linear Measurement- Error Models.” <em>Biometrika</em> 74 (4). [Oxford University Press, Biometrika Trust]: 703–16.</p>
</div>
<div id="ref-zeallot_package">
<p>Teetor, Nathan. n.d. <em>Zeallot: Multiple, Unpacking, and Destructuring Assignment</em>. <a href="https://github.com/nteetor/zeallot" class="uri">https://github.com/nteetor/zeallot</a>.</p>
</div>
<div id="ref-tibshirani1996">
<p>Tibshirani, R. 1996. “Regression shrinkage and selection via the Lasso.” <em>Journal of the Royal Statistical Society. Series B (Methodological)</em>, 267–88.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
